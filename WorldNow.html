<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>世界一周 窓の旅</title>
    <style>
        body { background-color: #f0f2f5; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; font-family: sans-serif; }
        /* 飛行機の窓枠のデザイン */
        .window-frame {
            position: relative; width: 300px; height: 450px; background-color: #000;
            border: 15px solid #dcdcdc; border-radius: 100px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5), inset 0 0 20px rgba(0,0,0,1);
            overflow: hidden; z-index: 1;
        }
        /* 映像エリア：YouTubeのロゴを隠すために拡大 */
        #player { position: absolute; top: -10%; left: -50%; width: 200%; height: 120%; pointer-events: none; }
        
        #overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: black; opacity: 1; transition: opacity 1.5s; z-index: 10; }
        .info { position: absolute; top: 30px; width: 100%; text-align: center; color: white; text-shadow: 0 2px 4px #000; z-index: 20; font-size: 14px; }
        .bar-bg { position: absolute; bottom: 0; left: 0; width: 100%; height: 4px; background: rgba(255,255,255,0.2); z-index: 20; }
        #bar { width: 0%; height: 100%; background: #fff; }

        /* スタート画面：最初からボタンを出す */
        #start-screen { position: fixed; inset: 0; background: #111; color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 100; }
        button { background: white; color: black; border: none; padding: 15px 40px; margin: 10px; border-radius: 30px; cursor: pointer; font-size: 18px; font-weight: bold; transition: 0.3s; }
        button:hover { background: #ddd; }
    </style>
</head>
<body>

    <div id="start-screen">
        <h2>世界一周 窓の旅</h2>
        <p>音を出して出発しますか？</p>
        <button onclick="initAndStart(true)">音ありで出発</button>
        <button onclick="initAndStart(false)">静かに出発</button>
    </div>

    <div class="window-frame">
        <div id="overlay"></div>
        <div class="info">
            <div id="loc">READY</div>
            <div id="time"></div>
        </div>
        <div id="player"></div>
        <div class="bar-bg"><div id="bar"></div></div>
    </div>

    <script>
        // あなたが送ってくれたURLのリスト
        const videos = [
            { id: 'rnXIjl_Rzy4', name: 'Shibuya, Tokyo' },
            { id: 'xXZqU5vnEug', name: 'Namibia, Africa' },
            { id: 'Sv9hcJ3k5h4', name: 'Pattaya, Thailand' },
            { id: 'OuCbntsMsWY', name: 'Times Square, NY' },
            { id: 'Yzl9offu5g8', name: 'ISS Space Station' },
            { id: 'zNahac5x0Tw', name: 'Miami Beach, USA' }
        ];

        let player;
        let isMuted = true;
        let currentIndex = 0;
        let apiLoaded = false;

        // YouTube APIの読み込み
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com";
        document.body.appendChild(tag);

        function onYouTubeIframeAPIReady() {
            apiLoaded = true;
        }

        // ボタンを押したときに実行される
        function initAndStart(sound) {
            isMuted = !sound;
            document.getElementById('start-screen').style.display = 'none';

            // APIの準備ができるまで一瞬待ってから作成
            const checkAPI = setInterval(() => {
                if (apiLoaded) {
                    clearInterval(checkAPI);
                    createPlayer();
                }
            }, 100);
        }

        function createPlayer() {
            player = new YT.Player('player', {
                height: '100%',
                width: '100%',
                videoId: videos[0].id,
                playerVars: { 
                    'autoplay': 1, 
                    'controls': 0, 
                    'rel': 0, 
                    'modestbranding': 1,
                    'mute': isMuted ? 1 : 0
                },
                events: {
                    'onReady': playVideo,
                    'onStateChange': (e) => {
                        // 動画が止まったら次へ
                        if (e.data === YT.PlayerState.ENDED) {
                            nextVideo();
                        }
                    }
                }
            });
        }

        function playVideo() {
            const v = videos[currentIndex];
            const overlay = document.getElementById('overlay');
            overlay.style.opacity = 1;

            setTimeout(() => {
                player.loadVideoById(v.id);
                if (isMuted) player.mute(); else player.unMute();
                document.getElementById('loc').innerText = v.name;
                
                setTimeout(() => {
                    overlay.style.opacity = 0;
                    startTimer();
                }, 2000);
            }, 1000);
        }

        function nextVideo() {
            currentIndex = (currentIndex + 1) % videos.length;
            playVideo();
        }

        function startTimer() {
            let count = 0;
            const bar = document.getElementById('bar');
            const interval = setInterval(() => {
                count++;
                bar.style.width = (count / 60 * 100) + '%';
                if (count >= 60) {
                    clearInterval(interval);
                    nextVideo();
                }
            }, 1000);
        }

        // 現在時刻の更新
        setInterval(() => {
            const now = new Date();
            document.getElementById('time').innerText = now.toLocaleTimeString();
        }, 1000);
    </script>
</body>
</html>
